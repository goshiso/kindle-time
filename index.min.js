"use strict";

var domApp = document.querySelector(".app");
var domTime = document.querySelector(".time");

function geturl(url) {
  var arr = url.split("?");
  if (!arr[1]) {
    return {};
  }
  var res = arr[1].split("&");
  var items = {};
  for (var i = 0; i < res.length; i++) {
    var a = res[i].split("=");
    items[a[0]] = a[1];
  }
  return items;
}

function render() {
  var time = new Date();
  var len = time.getTime();
  var offset = time.getTimezoneOffset() * 60000;
  var utcTime = len + offset;
  var date = new Date(utcTime + 3600000 * 9);

  // 时间（补零格式化）
  function pad2(n) {
    return n < 10 ? "0" + n : "" + n;
  }
  var hh = pad2(date.getHours());  // 小时 00–23
  var mm = pad2(date.getMinutes()); // 分钟 00–59
  var timeText = hh + "<br>" + mm;

  if (domTime.innerHTML != timeText) domTime.innerHTML = timeText;
}

var urlQuery = geturl(location.href);
var config = {
  fontSize: +(urlQuery.fs || 7),
  rotate: urlQuery.r,
  lang: urlQuery.l
};

domTime.style.fontSize = config.fontSize * 1.5 + "rem";
domApp.style.cssText = "-webkit-transform: rotate("
  .concat(config.rotate || 0, "deg) translate3d(-50%,-50%,0)");

render();
setInterval(function () {
  render();
}, 1000);
